# Copyright 2023 Nokia
# Licensed under the BSD 3-Clause License.
# SPDX-License-Identifier: BSD-3-Clause

name: ansible

topology:
  kinds:
    nokia_srsim:
      image: registry.srlinux.dev/pub/nokia_srsim:${SROS_VERSION:=25.7.R2}
      license: xxxxx-xxxxxx-xxxxxx-xxxxxx-xxxxxx      
      # image: ghcr.io/nokia/nokia_srsim:${SROS_VERSION:=25.7.R2}

  nodes:
    classic:
      kind: nokia_srsim
      type: sr-1
      mgmt-ipv4: 172.20.20.220
      startup-config: |
        /configure card 1 card-type iom-1
        /configure card 1 mda 1 mda-type me6-100gb-qsfp28
        /configure card 1 mda 2 mda-type me12-100gb-qsfp28

        /configure port 1/1/c1 connector breakout c1-100g
        /configure port 1/1/c1 admin-state enable
        /configure port 1/1/c1/1 ethernet mode network
        /configure port 1/1/c1/1 ethernet lldp dest-mac nearest-bridge receive true
        /configure port 1/1/c1/1 ethernet lldp dest-mac nearest-bridge transmit true
        /configure port 1/1/c1/1 admin-state enable

        /configure router "Base" router-id 10.0.0.220
        /configure router "Base" autonomous-system 65000

        /configure router "Base" interface "system" ipv4 primary address 10.0.0.220
        /configure router "Base" interface "system" ipv4 primary prefix-length 32

        /configure router "Base" interface "toMD" port 1/1/c1/1
        /configure router "Base" interface "toMD" ipv4 primary address 192.168.100.0
        /configure router "Base" interface "toMD" ipv4 primary prefix-length 31

        /configure system contact "nokia"
        /configure system location "Vienna (Austria)"
        /configure system coordinates "N 48 12 29, E 16 22 20"
        /configure system security snmp community "public" access-permissions rwa
        /configure system management-interface configuration-mode mixed
        /configure system management-interface cli cli-engine [classic-cli md-cli]

    md:
      kind: nokia_srsim
      type: sr-1
      mgmt-ipv4: 172.20.20.222
      startup-config: |
        /configure card 1 card-type iom-1
        /configure card 1 mda 1 mda-type me6-100gb-qsfp28
        /configure card 1 mda 2 mda-type me12-100gb-qsfp28

        /configure port 1/1/c1 connector breakout c1-100g
        /configure port 1/1/c1 admin-state enable
        /configure port 1/1/c1/1 ethernet mode network
        /configure port 1/1/c1/1 ethernet lldp dest-mac nearest-bridge receive true
        /configure port 1/1/c1/1 ethernet lldp dest-mac nearest-bridge transmit true
        /configure port 1/1/c1/1 admin-state enable

        /configure router "Base" router-id 10.0.0.222
        /configure router "Base" autonomous-system 65000

        /configure router "Base" interface "system" ipv4 primary address 10.0.0.222
        /configure router "Base" interface "system" ipv4 primary prefix-length 32

        /configure router "Base" interface "toClassic" port 1/1/c1/1
        /configure router "Base" interface "toClassic" ipv4 primary address 192.168.100.1
        /configure router "Base" interface "toClassic" ipv4 primary prefix-length 31

        /configure system contact "nokia"
        /configure system location "Graz (Austria)"
        /configure system coordinates "N 47 4 14, E 15 26 18"
        /configure system security snmp community "public" access-permissions rwa

  links:
    - endpoints: ["classic:1/1/c1/1", "md:1/1/c1/1"]
