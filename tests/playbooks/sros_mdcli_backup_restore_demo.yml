# Copyright 2025 Nokia
# Licensed under the BSD 3-Clause License.
# SPDX-License-Identifier: BSD-3-Clause

---
- hosts: clab-ansible-md
  gather_facts: No

  tasks:
  - name: backup
    ansible.netcommon.cli_config:
      backup: yes
      backup_options:
        dir_path: /tmp
    register: backup_info

  - name: backup details
    debug:
      msg: "{{backup_info}}"

  - name: do some config
    ansible.netcommon.cli_config:
      config: |
        configure service
          customer nobody
            customer-id 100
            back
          vpls midnight
            service-id 100
            customer nobody
          exit all

  - name: "restore backup (Success: MDCLI does support restore)"
    cli_config:
      replace: 'true'
      config: "{{ lookup('file', backup_info.backup_path) }}"
...
