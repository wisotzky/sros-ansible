# Copyright 2025 Nokia
# Licensed under the BSD 3-Clause License.
# SPDX-License-Identifier: BSD-3-Clause

---
- hosts: clab-ansible-classic
  gather_facts: No
  vars:
    ansible_network_os: nokia.sros.classic
    ansible_connection: network_cli

  tasks:
  - name: backup
    nokia.sros.cli_config:
      backup: yes
      backup_options:
        dir_path: /tmp
    register: backup_info

  - name: backup details
    debug:
      msg: "{{backup_info}}"

  - name: do some config
     nokia.sros.cli_config:
      config: |
        configure service
          customer 100 name nobody create
            back
          vpls 100 name midnight customer 100 create
            exit all

  - name: "restore backup (Error: Classic-CLI does not support restore)"
    cli_config:
      replace: 'true'
      config: "{{ lookup('file', backup_info.backup_path) }}"
...